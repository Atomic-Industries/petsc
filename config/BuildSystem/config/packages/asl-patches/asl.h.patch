1,23c1,17
< /****************************************************************
< Copyright (C) 1997-2001 Lucent Technologies
< All Rights Reserved
< 
< Permission to use, copy, modify, and distribute this software and
< its documentation for any purpose and without fee is hereby
< granted, provided that the above copyright notice appear in all
< copies and that both that the copyright notice and this
< permission notice and warranty disclaimer appear in supporting
< documentation, and that the name of Lucent or any of its entities
< not be used in advertising or publicity pertaining to
< distribution of the software without specific, written prior
< permission.
< 
< LUCENT DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,
< INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS.
< IN NO EVENT SHALL LUCENT OR ANY OF ITS ENTITIES BE LIABLE FOR ANY
< SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
< WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER
< IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
< ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
< THIS SOFTWARE.
< ****************************************************************/
---
> /*******************************************************************
> Copyright (C) 2016 AMPL Optimization, Inc.; written by David M. Gay.
> 
> Permission to use, copy, modify, and distribute this software and its
> documentation for any purpose and without fee is hereby granted,
> provided that the above copyright notice appear in all copies and that
> both that the copyright notice and this permission notice and warranty
> disclaimer appear in supporting documentation.
> 
> The author and AMPL Optimization, Inc. disclaim all warranties with
> regard to this software, including all implied warranties of
> merchantability and fitness.  In no event shall the author be liable
> for any special, indirect or consequential damages or any damages
> whatsoever resulting from loss of use, data or profits, whether in an
> action of contract, negligence or other tortious action, arising out
> of or in connection with the use or performance of this software.
> *******************************************************************/
271c265
< 	void (*Xknown)		(ASL*, real*, fint*);
---
> 	int  (*Xknown)		(ASL*, real*, fint*);
613a608
> 	void (*opify)(ASL*);
623a619,624
> 
> 	/* memory use statistics */
> 	size_t temp_rd_bytes;	/* bytes temporarily allocated during .nl read */
> 	size_t tot_M1z_bytes;	/* total allocated by M1alloc and M1zapalloc */
> 	size_t rd_M1z_bytes;	/* tot_M1z_bytes after reading the .nl file */
> 
665d665
< #define CgradZ		asl->i.CgradZ_
696a697
> #ifndef MPI_VERSION
697a699
> #endif
831,832c833,834
< 	ASL_find_c_class = 32,	/* Find c_class and c_class_max: see nlp.h */
< 	ASL_find_o_class = 64,	/* Find o_class and o_class_max: or nlp2.h */
---
> 	ASL_find_c_class = 32,	/* Find c_class and c_class_max: see nlp.h and nlp2.h */
> 	ASL_find_o_class = 64,	/* Find o_class and o_class_max: see nlp.h and nlp2.h */
916c918,921
< 	ASL_write_CR = 2
---
> 	ASL_write_CR = 2,
> 	ASL_write_binary = 4,
> 	ASL_write_no_X0 = 8,
> 	ASL_write_no_pi0 = 16
976a982
>  extern int degree_ASL(ASL*, int, void**);
983c989
<  extern char *dtoa(double, int, int, int*, int*, char **);
---
>  extern char *dtoa_r(double, int, int, int*, int*, char**, char*, size_t);
996d1001
<  extern void freedtoa(char*);
1110a1116,1120
> extern void ACQUIRE_DTOA_LOCK(unsigned int);
> extern void FREE_DTOA_LOCK(unsigned int);
> extern int dtoa_get_threadno(void);
> extern void init_dtoa_locks(void);
> extern void set_max_dtoa_threads(unsigned int);
1174a1185,1189
> #ifdef ALLOW_OPENMP
> #undef MULTIPLE_THREADS
> #define MULTIPLE_THREADS
> #endif
> 
1181c1196
< #define MEM_LOCK 3
---
> #define MEM_LOCK 2
1184c1199
< #define MBLK_LOCK 4
---
> #define MBLK_LOCK 3
1187c1202
< #define HESOPROD_LOCK 5
---
> #define HESOPROD_LOCK 4
