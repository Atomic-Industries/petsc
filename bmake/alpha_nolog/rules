# $Id: base,v 1.15 1997/09/17 04:31:45 bsmith Exp balay $ 

PARCH    = alpha
CC       = cc -DPARCH_alpha
#
#  Indicates the version of the compiler you are using; if you do not know
#  how to get the version number then use: unknown
#
CCV      = unknown
#
FC       = f77 -w
AR       = ar
RM       = rm -f
RANLIB   = ranlib
OMAKE    = make 
SHELL    = /bin/sh
CLINKER  = cc $(COPTFLAGS) -Wl,-rpath,$(LDIR):$(DYLIBPATH)
FLINKER  = f77 $(FOPTFLAGS) -Wl,-rpath,$(LDIR):$(DYLIBPATH)
SYS_LIB  =

FCONF    = -DHAVE_FORTRAN_UNDERSCORE -DHAVE_64BITS 
CONF     = -DHAVE_64BITS -DHAVE_PWD_H -DHAVE_STRING_H -DHAVE_MALLOC_H \
           -DHAVE_STDLIB_H -DHAVE_SWAPPED_BYTES -DHAVE_X11 \
           -DHAVE_DRAND48  -DHAVE_GETDOMAINNAME \
           -DHAVE_UNISTD_H -DHAVE_SYS_TIME_H -DHAVE_UNAME $(FCONF)

include $(PETSC_DIR)/bmake/common

libc: $(OBJSC)
	ar crl $(LIBNAME) $(OBJSC)
libf: $(OBJSF)
	ar crl $(LIBNAME) $(OBJSF)

#######
.F.o:
	$(RM) $*.f
	cpp $(CFLAGS)  -E $< | grep -v '^ *#' > $*.f
	$(FC) -c $(FFLAGS) $(FOPTFLAGS) $*.f
	$(RM) $*.f

.F.a: 
	$(RM) $*.f
	cpp $(CFLAGS)  -E $< | grep -v '^ *#' > $*.f
	$(FC) -c $(FFLAGS) $(FOPTFLAGS) $*.f
	$(RM) $*.f
	$(AR) cr $(LIBNAME) $*.o
	$(RM) -f $*.o

shared: chkopts_basic
	-@echo making shared libraries in $(LDIR) ;\
	cd $(LDIR); \
	for LIBNAME in $(SHLIBS) ; \
	  do $(LD) -shared  -all  $$LIBNAME.a  -o $$LIBNAME.$(SLSUFFIX)  > /dev/null 2>&1; \
	done
