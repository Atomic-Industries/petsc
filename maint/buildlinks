#! /bin/csh
#
# Builds PETSc shadow directory.  This is used in conjunction with addlinks.
#

set shadowdir=$1
set petscdir=/home/bsmith/petsc
if ($shadowdir == /sphome/curfman/petsc) then
  set suffix=SP
else 
  set suffix=""
endif

cd $petscdir
/bin/rm -f $petscdir/maint/links$suffix.log
echo "Building links from" $petscdir "to" $shadowdir "(`date`)" \
     > $petscdir/maint/links$suffix.log
if ($shadowdir == /sphome/curfman/petsc) then
  find . \( -name RCS -prune -o -name docs -prune -o -name lib -prune \) \
        -o -type d -exec $petscdir/maint/addlinks $shadowdir \{\} \
        >>& $petscdir/maint/links$suffix.log \;
else
# prune rs6000 and freebsd because these are already symbolic links to 
# the main PETSc directory (needed for testexamples)
  find . \( -name RCS -prune -o -name docs -prune -o -name freebsd -prune \
            -o -name rs6000 -prune \) \
        -o -type d -exec $petscdir/maint/addlinks $shadowdir \{\} \
        >>& $petscdir/maint/links$suffix.log \;
endif
echo "Finished building links from" $petscdir "to" $shadowdir "(`date`)" \
     >> $petscdir/maint/links$suffix.log
