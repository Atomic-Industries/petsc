#! /bin/csh
#
# Generates petsc-patches.tar.gz file based on the list of files
# specified in docs/tex/petsc-patches-file-list.
# This generated tarfile should be copied over to
# the PETSc ftp directory.
#
# This command should be invoked from the scratch PETSC_DIR locaton
# where the current patches reside
#
/bin/rm -f ~/petsc-patches.tar.gz ~/petsc-patchesnt.tar.gz 
grep '##' /home/bsmith/petsc/docs/tex/petsc-patches.html  | cut -d '>' -f 2 >! \
         /tmp/petsc-patches-file-list.tmp
tar cf ~/petsc-patches.tar -I /tmp/petsc-patches-file-list.tmp
/bin/rm -f /tmp/petsc-patches-file-list.tmp
gzip ~/petsc-patches.tar
chgrp petsc ~/petsc-patches.tar.gz
chmod g+w ~/petsc-patches.tar.gz
#
# Now build the version that works with NT
#
/bin/rm -rf /tmp/petscpatchdir
/bin/mkdir /tmp/petscpatchdir
cd  /tmp/petscpatchdir
gnutar -xzf ~/petsc-patches.tar.gz
cd  /tmp/petscpatchdir
/home/bsmith/petsc/maint/makecpp.tcl /tmp/petscpatchdir
tar -cf ~/petscnt-patches.tar *
gzip ~/petscnt-patches.tar
cd ~/
/bin/rm -rf /tmp/petscpatchdir


