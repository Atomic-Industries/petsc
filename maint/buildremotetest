#! /bin/csh
# 
# Builds and transports the petsc.tar.gz file for remote 
# automatic testing.
#
#
# send copy off to UCLA, and NERSC for testing
#
cd /home/bsmith/petsc/maint
/bin/rm -f nightlylogs/ftp.log
echo "ftp logging: `date` " > nightlylogs/ftp.log
chmod 660 nightlylogs/ftp.log
builddist >>& /dev/null
/bin/rm -f ~/petsc.tar.gz
/usr/local/bin/gzip ~/petsc.tar
chmod ug+w ~/petsc.tar.gz
autoftp joshua.math.ucla.edu bsmith put ~/petsc.tar.gz petsc.tar.gz >>& nightlylogs/ftp.log
autoftp h4p.llnl.gov bsmith put ~/petsc.tar.gz petsc.tar.gz >>& nightlylogs/ftp.log
autoftp ursula.cs.msstate.edu curfman put ~/petsc.tar.gz petsc.tar.gz >>& nightlylogs/ftp.log
#
#  Wait 6.5 hours then retrieve the results
#
sleep 30000
autoftp joshua.math.ucla.edu bsmith get buildtest.log /home/bsmith/petsc/maint/nightlylogs/solaris.log >>& nightlylogs/ftp.log
autoftp h4p.llnl.gov bsmith get buildtest.log /home/bsmith/petsc/maint/nightlylogs/t3d.log >>& nightlylogs/ftp.log
autoftp ursula.cs.msstate.edu curfman get buildtest.log /home/bsmith/petsc/maint/nightlylogs/linux.log >>& nightlylogs/ftp.log

chmod -f g+rw /home/bsmith/petsc/maint/nightlylogs/solaris.log /home/bsmith/petsc/maint/nightlylogs/t3d.log /home/bsmith/petsc/maint/nightlylogs/linux.log >>& nightlylogs/ftp.log
echo "ftp logging complete: `date` " >> nightlylogs/ftp.log


