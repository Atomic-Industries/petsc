\documentstyle[11pt]{article}


\def\note{\medskip \noindent Note:\begin{em}}
\def\endnote{\end{em} \medskip}

\input epsf

\begin{document}


\begin{titlepage}

\title{Utilty Programs for the Portable, Extensible Toolkit for Scientific
	Computing (PETSc)\thanks{Work performed at Argonne National
	Laboratory, a contract Laboratory of the United States Deparment of
	Energy.}}

\author{\\ \\ \\ \\ by \\ \\ Matt Hille\thanks{Participant in the Summer 1995 Student
   Research Participation Program.  This program is coordinated by the 
   Division of Educational Programs.} \\ Washington State University \\ 
   Pullman, WA \\ \\ \\
\and
   \\ \\ \\ Dr. Barry Smith \\ Division of Mathematics \& Computer Science \\
   Argonne National Laboratory}

\end{titlepage}
\maketitle

\newpage 

\tableofcontents

\newpage
\section{Getting Started}

******************************************************************
IMPORTANT NOTE: This document is now obselete, as it has been absorbed
as a chapter of the PETSc users manual.  Do NOT change this file, but
instead edit the users manual directly!!!
******************************************************************


The PETSc utility programs were written using John Ousterhout's Tcl
and the Tk Toolkit \footnote{University of California at Berkeley}.
Therefore, in order to use the PETSc utility programs, the Tcl and Tk
packages must be installed on your system.  If they are not installed
on your system, Tcl and Tk can be obtained via anonymous {\tt ftp}
from {\tt ftp.cs.berkeley.edu}.  The Tcl and Tk packages are located
in the {\tt /ucb/tcl} directory.

In order for PETSc Simulator and PETSc Options to work properly, a
slight modification of the source code is required.  Using any text
editor, simply load {\tt petscsim} (or {\tt petscopts}) and change the
first line in the source code to point to the proper location of where
{\tt wish} can be found.  For example, if {\tt wish} is located at
{\tt /usr/bin/wish}, the first line for each program should be changed
to:
\begin{verbatim}
  #! /usr/local/wish -f
\end{verbatim}
After {\tt petscsim} and {\tt petscopts} have been modified, they are
now ready to run.

\newpage
\section{Using PETSc Simulator}

PETSc Simulator interprets the profiling data created whenever a PETSc
program is executed with the {\tt -log\_all} or {\tt -log} command
line options.  PETSc Simulator generates a tree-shaped hierarchy whose
nodes contain icons that uniquely identify PETSc objects.  PETSc
objects are then color-coded to denote the object's state of activity.
A sample tree is shown in figure \ref{example tree}.

PETSc Simulator's abstract interpretation of the profiling data allows
the application programmer to view the objects created during the
execution of a PETSc program.  A number of built-in commands
enable the application programmer to easily navigate through the
simulation.

\begin{figure}
\centerline{\epsffile{treep.ps}}
\caption{A sample PETSc Simulator Object tree.}
\label{example tree}
\end{figure}

\subsection{Running PETSc Simulator}

To begin PETSc Simulator, type {\tt petscsim} from the UNIX shell
prompt.  If a PETSc log file is given as a command line option to {\tt
petscsim}, then PETSc Simulator immediately loads and interprets the
profiling data.

\begin{table}
\begin{tabular}{||l||l||} \hline
{\bf Argument}                  & {\bf Purpose} \\ \hline
{\tt -def\_file filename}       & The location of the definitions file \\ \hline
{\tt -time}                    & Show the time \\ \hline
{\tt -notime}                  & Do not show the time \\ \hline
{\tt -stepsize N}              & Set the stepsize to N \\ \hline
{\tt -delay N}                 & Set the delay to N milliseconds \\ \hline 
{\tt -printer\_dest DESTINATION}& Set the destination (File or Printer) \\ \hline
{\tt -print\_command COMMAND}   & Set the postscript print command \\ \hline
{\tt -printer PRINTER}         & Specify the printer \\ \hline
{\tt -print\_orientation 1 or 0}& 1 = landscape , 0 = portrait \\ \hline
{\tt -print\_color}             & Specify color mode (color, gray, mono) \\ \hline
\end{tabular}
\label{PETSc Simulator command line options}
\caption{Command line arguments supported by PETSc Simulator}
\end{table}

In addition to supplying a log file as a command line argument, PETSc
Simulator also supports several other command line arguments.  Table
\ref{PETSc Simulator command line options} lists the command line
options supported by PETSc Simulator.  The command line options
override the default values taken from the {\tt .petscsimrc} file.

\subsection{Loading the Profiling Data}

To load a PETSc log file, simply run PETSc Simulator, giving the log 
file name as a command line argument:
\begin{verbatim}
   petscsim Log.0
\end{verbatim}
This command invokes PETSc Simulator and automatically loads and
interprets the profiling data contained in the file {\tt Log.0}.

PETSc Simulator can also be run without a log file given as a command
line argument.  In this case, the user must load the log file from
within PETSc Simulator.  To do this, simply select the ``Open File''
command from the file menu.  PETSc Simulator will automatically
present the user with another window from which the file can be
selected.

\subsection{Loading a Configuration File}

PETSc configuration files contain specific information that
determines the graphical representation of PETSc objects within PETSc
Simulator.  Whenever PETSc Simulator is invoked, a configuration file
is automatically read.  The location of this file is specified in the
{\tt .petscsimrc}, which is stored in the user's home directory.  By
default, this points to the configuration file included with PETSc
Simulator ({\tt \$PETSC\_DIR/bin/petscsim.cfg}).  However, this can be
changed to point to a configuration file created by the application
programmer.  For more information about changing the {\tt .petscsimrc}
file, refer to section 2.7.

Even though PETSc Simulator loads a definitions file whenever it is
initially run, a file of new definitions can be loaded from within PETSc
Simulator at any time.  This command is found in the file menu.
Loading a new definitions file will automatically update all PETSc
objects.

\subsection{Printing a PETSc Simulator Object Tree}

The ``print'' command of the file menu displays a dialog box from which
the user can change the printing options.  The default values are
loaded from {\tt .petscsimrc} when PETSc Simulator is first run.

When the proper options are set for printing, simply click on the
``print'' button or press ``return''.  If the user is printing to a file,
another dialog box will appear from which the user may specify the
output filename.

\begin{note}
Currently, PETSc Simulator can only print trees whose size is less
than 1024x768 (measured in pixels).  If the scrollbars are needed to
view any parts of a tree, it is very unlikely that the whole tree will
be printed.  This presents no problem, however, when the tree is
printed to a file.
\end{note}

\subsection{Exiting PETSc Simulator}

To exit PETSc Simulator, simply select the ``Exit'' option of the file
menu.  When this action is confirmed, PETSc Simulator will terminate
and return the user to the calling shell.

\subsection{The Simulation}

\subsubsection{Navigating Through the Simulation}

Once a file has been loaded by PETSc Simulator, the user can navigate
through the simulation by using PETSc Simulator's play bar.  The play
bar is located at the bottom of the window and contains buttons whose
appearances and functioning resemble the buttons on a tape player.
From left to right, these buttons have the following functions:
\begin{itemize}
\item Rewind - Rewinds the simulation to the zeroth step.
\item Step Backward - Steps backward through the simulation.
\item Play Backward - Plays the simulation in reverse with an appropriate delay between steps.  
\item Stop - Brings the simulation to a halt.
\item Play Forward - Plays forward through the simulation with an appropriate delay between steps.
\item Step Forward - Steps forward through the simulation
\item Finish - Immediately jumps to the last step of the simulation.
\end{itemize}

In addition to the play bar buttons, the scale directly below these
buttons enables the user to navigate to an arbitrary position in the
simulation.  To use the scale, simply click the left mouse button at
the desired position on the scale.  (The scale ranges from the zeroth
step to the last step of the simulation.)  The scale is scaled and
labeled appropriately.

All of the above functions can also be accessed through the ``player''
menu.  Selecting the player menu lists the commands in addition to
their accelerator keys.

The player menu also contains two additional commands that allow the
user to jump to an arbitrary step in the simulation or to an arbitrary
time during the simulation.  When one of these commands is invoked,
the user is prompted for the proper target jump value.

\subsubsection{The View Menu}

The View menu contains several additional commands that cab be useful
in the profiling of a PETSc program.  These commands enable the user
to view the raw profiling data as well as various statistics that
program performance.

\subsubsection{Changing Simulation Options}

The ``options'' menu allows the user to change certain options that
are set by default whenever PETSc Simulator is initially invoked.
(The default values are defined in {\tt .petscsimrc}.) These options
include the step size when stepping through the simulation, the delay
between events when playing through the simulation, and the colors
chosen to denote the internal states of the PETSc objects.

The simulation's step size can be changed at any time during the
simulation by selecting the ``Step size'' command of the ``Options''
menu.  Whenever the user clicks on the this selection, a dialog box
appears prompting the user for the desired step size.  Valid step
sizes range from $1$ to the total number of events in the simulation.

To change the delay, simply select the ``delay'' command of the options
menu.  A cascading menu presents the user with a few built-in delays
which include: none, real-time, and second delay.  (The real-time
delay option causes delays between events in the simulation to be
proportionate to the delays in the actual execution of the PETSc
program.)  To specify a user-defined delay, the user simply clicks on
the ``after delay'' selection.  When this has been done, the user will be
presented with a dialog box in which the user can specify the desired
delay in milliseconds.  Only values ranging from $1$ to $2000$ are
valid.

The final selection on the ``Options'' menu presents the user with a
cascading menu with entries that allow the user to change PETSc
Simulator's object color-coding scheme.  Selecting any one of the
entries presents the user with another window from which the color may
be chosen.  (The colors are taken from {\tt /usr/lib/X11/rgb.txt}.)

\subsection{Advanced Features}

PETSc Simulator allows the user to define/redefine the graphical
representation of PETSc objects.  This is accomplished by creating a
configuration file, a Tcl script file, which includes specific
definitions for group shapes, group labels, object icons, object
labels, and action strings.  Whenever PETSc Simulator is invoked, a
configuration file is read from the location specified in the {\tt
.petscsimrc} file.  By default, it is set to point to the
configuration file included with the PETSc package.  ({\tt
\$PETSC\_DIR/bin/petscsim.cfg}).  Allowing the application programmer
to create a customized configuration file enables PETSc Simulator to
interpret the profiling data even when new PETSc objects have been
created.

\subsubsection{Group Definitions}

\begin{table}
\begin{tabular}{||l||l||} \hline
Group                              & Object\_cookie \\ \hline
Viewers                            &  0 \\ \hline
Index Sets                         &  1 \\ \hline
Vectors                            &  2 \\ \hline
Vector Scattering                  &  3 \\ \hline
Matrices                           &  4 \\ \hline
Draw (simple graphics)             &  5 \\ \hline
Line Graphs                        &  6 \\ \hline
Krylov Subspace Solvers            &  7 \\ \hline
Preconditioners                    &  8 \\ \hline
Simplified Linear Equations Solvers     &  9 \\ \hline
Grids                              & 10 \\ \hline
Stencils                           & 11 \\ \hline
Simplified Nonlinear Equations Solvers & 12 \\ \hline
Distributed Arrays                 & 13 \\ \hline
Matrix Scattering                  & 14 \\ \hline
\end{tabular}
\caption{Object group definitions currently used by PETSc}
\label{PETSc object definitions}
\end{table}

Each PETSc object group is identified by its integer-valued object
cookie.  For example, Table \ref{PETSc object definitions} lists the
currently available object groups and their associated object cookies.

For each group of objects, the PETSc Simulator requires the following
definitions:
\begin{verbatim}
set GroupShape(OBJECT_COOKIE) SHAPE 
set GroupDesc(OBJECT_COOKIE) ``GROUP DESCRIPTION''
\end{verbatim}
where OBJECT\_COOKIE is the integer used to identify the group of objects and SHAPE is one of the pre-defined shapes used by PETSc Simulator.  These shapes include:
\begin{verbatim}
Square
Thin_RectangleV
Thin_RectangleH
Rectangle
Wide_Rectangle
Circle
Tall_Oval
Wide_Oval
Up_Triangle
Down_Triangle
Octagon
\end{verbatim}

{\tt GROUP DESCRIPTION} is a line of text enclosed by quotes to describe the object group.  For example, vectors have the following Group descriptions:
\begin{verbatim}
set GroupShape(2) Thin_RectangeV 
set GroupDesc(2) ``Vectors''
\end{verbatim}

\subsubsection{Object Definitions}

Within each group, the object is identified with the use of a second integer ({\tt OBJECT\_TYPE}).  This specifies the type of object within the object group.  PETSc Simulator requires both a name and an icon to be defined for every object.  These definitions have the following syntax:
\begin{verbatim}
set Icon(OBJECT_COOKIE,OBJECT_TYPE) ``-text TEXT'' or 
set Icon(OBJECT_COOKIE,OBJECT_TYPE) ``-bitmap @BITMAP_LOC'' 
set Name(OBJECT_COOKIE,OBJECT_TYPE) ``OBJECT DESCRIPTION''
\end{verbatim}
where {\tt TEXT} is a short description of the object (used if a bitmap is inappropriate) and {\tt BITMAP\_LOC} is the location of the bitmap graphic.  The {\tt OBJECT DESCRIPTION} is a line of text used to describe the object.  As an example, consider the following definitions:
\begin{verbatim}
set Icon(2,0) ``-bitmap @$env(PETSC_DIR)/bitmaps/vector.bit'' 
set Name(2,0) ``Sequential Vector'' 
set Icon(2,1) ``-bitmap @$env(PETSC_DIR)/bitmaps/vectorp.bit'' 
set Name(2,1) ``Parallel Vector''
\end{verbatim}
Notice the syntax that Tcl requires for the location of the bitmap.  The bitmap location must be preceded by a $@$ in order for PETSc Simulator the work properly.   {\tt \$env(\$PETSC\_DIR)} is used to access the value of the environmental variable {\tt PETSC\_DIR}.  To use the value of any other environmental variables in specifying a file location use the following syntax:
\begin{verbatim}
   $env(ENVIRONMENTAL_VARIABLE)
\end{verbatim}
in the expression.

If you would like to create your own bitmap picture to represent an
object, simply create the bitmap using a program such as {\tt bitmap.}
Once this is done, PETSc Simulator must know the location of the
bitmap.  This is accomplished by specifying the precise location in
the file system where the bitmap graphic can be found.  For example,
suppose that one creates a new bitmap to symbolize a parallel vector.
Since the bitmap is located in the user's home directory, the
following definition will NOT CREATE an error:
\begin{verbatim}
   set Icon(2,1) ``-bitmap $env(HOME)/vectorp.bit''
\end{verbatim}

For more examples on defining additional PETSc objects and informat
about how PETSc defines the object types, see {\tt petscsim.cfg}.

\subsubsection{Action Strings}

When certain actions occur during the execution of a PETSc program,
these actions are also recorded in the profiling data.  Once again,
PETSc uses an integer to specify the type of action that is being
performed.  PETSc Simulator interprets the actions using the
definitions contained in {\tt action()} string definitions.  These
definitions are also located in the configuration file.  An action
definition has the following syntax:
\begin{verbatim}
   set Action(ACTION_ID) ``ACTION''
\end{verbatim}
where {\tt ACTION\_ID} is an integer which encodes the action and {\tt ACTION} is a descriptive string.  Currently, PETSc Simulator uses the action definitions as defined in {\tt petscsim.cfg}.

\newpage

\section{Using PETSc Options}

PETSc Options is a PETSc utility program that enables the application
programmer to modify his or her personal {\tt .petscrc} file.  The {\tt
.petscrc} file contains a list of options that will be passed to
a PETSc program whenever it is executed.  This file has the
following format:
\begin{verbatim}
   -optionname possible_value
   -anotheroptionname possible_value
\end{verbatim}
Even though this file can be manually modified by the application
programmer with any text editor, PETSc Options greatly simplifies this
task.

\subsection{Running PETSc Options}

The command {\tt petscopts} will invoke PETSc Options from the UNIX
shell prompt.  Any entries contained in the {\tt .petscrc} file of the
user's home directory will automatically be interpreted by PETSc
Options.  Once inside PETSc Options, a number of entry boxes, check
buttons, radio buttons, and other widgets allow the application
programmer to specify the options that should be saved in the {\tt
.petscrc} file for future use.

PETSc Options can also write the PETSc command line options to a file
other than the default {\tt .petscrc} file. To do so, simply run PETSc
Options with the filename as a command line argument:
\begin{verbatim}
   petscopts file
\end{verbatim}
From within PETSc Options, a different file can be loaded at any time
by selecting the ``Open file'' option of the file menu.

\subsection{Getting Help}

Even though many of PETSc's command line options are self-explanatory,
a single descriptive line of text is displayed at the bottom of the
window whenever the pointer is positioned over any check button, radio
button, or entry that specifies an option.

\subsection{Exiting PETSc Options}

The user can exit PETSc Options at any time by selecting the exit
button from the file menu.  If a {\tt .petscrc} file was loaded when
PETSc Options was initiated, the user is asked if the current or
original settings (or neither) should be saved in {\tt .petscrc}.

\end{document}






